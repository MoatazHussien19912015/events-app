{"ast":null,"code":"var _jsxFileName = \"/media/moataz/data/my-projects/react projects/events-app/frontend/src/components/pages/RegisterPage.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { register, upload_image } from '../../store/actions/userActions';\nimport Joi from 'joi-browser';\nimport { isEmpty } from '../../utils';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst RegisterPage = _ref => {\n  _s();\n\n  let {\n    history\n  } = _ref;\n  const [username, setUserName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [image, setImage] = useState('anonymous');\n  const [errors, setErrors] = useState({});\n  const schema = {\n    username: Joi.string().required(),\n    email: Joi.string().email().required(),\n    password: Joi.string().required(),\n    confirmPassword: Joi.string().required()\n    /* ,\n    image: Joi.string() */\n\n  };\n\n  const validate = form => {\n    const result = Joi.validate(form, schema, {\n      abortEarly: false\n    });\n    return result;\n  };\n\n  const validateInput = (name, value) => {\n    const {\n      error\n    } = Joi.validate({\n      [name]: value\n    }, {\n      [name]: schema[name]\n    });\n    if (error) setErrors({ ...errors,\n      [name]: error.details[0].message\n    });else {\n      let newErrors = { ...errors\n      };\n      delete newErrors[name];\n      setErrors({ ...newErrors\n      });\n    }\n  };\n\n  const dispatch = useDispatch();\n  const uploaded_image = useSelector(state => state.authReducer.uploaded_image);\n  const user = useSelector(state => state.authReducer.user);\n\n  const handleChange = evt => {\n    if (evt.target.name == 'username') {\n      setUserName(evt.target.value);\n    } else if (evt.target.name == 'email') {\n      setEmail(evt.target.value);\n    } else if (evt.target.name == 'password') {\n      setPassword(evt.target.value);\n    } else if (evt.target.name == 'confirmPassword') {\n      setConfirmPassword(evt.target.value);\n    }\n    /* else if (evt.target.name == 'image') { console.log(evt.target.files[0].name);  handleFileUpload(evt);} */\n\n\n    validateInput(evt.target.name, evt.target.value);\n  };\n\n  const handleSubmit = evt => {\n    evt.preventDefault();\n    const form = {\n      username,\n      email,\n      password,\n      confirmPassword\n    };\n    const {\n      error,\n      value\n    } = validate(form);\n\n    if (!isEmpty(error)) {\n      let formErrors = {};\n\n      for (let i = 0; i < error.details.length; i++) {\n        formErrors[error.details[i].path[0]] = error.details[i].message;\n      }\n\n      if (form.password != form.confirmPassword) {\n        formErrors['password'] = formErrors['password'] ? formErrors['password'] + '  password and confirmed password are not match' : formErrors['password'];\n        formErrors['confirmPassword'] = formErrors['confirmPassword'] ? formErrors['confirmPassword'] + '  password and confirmed password are not match' : formErrors['confirmPassword'];\n      }\n\n      setErrors(formErrors);\n    } else {\n      if (image) {\n        form['image'] = image;\n      }\n\n      dispatch(register(form));\n    }\n  };\n\n  const handleFileUpload = evt => {\n    const x = new FormData();\n    x.append('avatar', evt.target.files[0]);\n    dispatch(upload_image(x));\n  };\n\n  useEffect(() => {\n    setImage(uploaded_image);\n\n    if (!isEmpty(user)) {\n      history.push('/');\n    }\n  }, [uploaded_image, user]);\n\n  const isEmptyForm = () => {\n    return username + email + password + confirmPassword + image == \"\";\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"username\",\n          children: \"Username:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"username\",\n          placeholder: \"Enter name\",\n          name: \"username\",\n          value: username,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), (errors === null || errors === void 0 ? void 0 : errors.username) && /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-danger\",\n        children: errors.username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 30\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"email\",\n          children: \"email:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          className: \"form-control\",\n          id: \"email\",\n          placeholder: \"Enter email\",\n          name: \"email\",\n          value: email,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }, this), (errors === null || errors === void 0 ? void 0 : errors.email) && /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-danger\",\n        children: errors.email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 27\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"password1\",\n          children: \"Password:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"form-control\",\n          id: \"password1\",\n          placeholder: \"Enter password\",\n          name: \"password\",\n          value: password,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), (errors === null || errors === void 0 ? void 0 : errors.password) && /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-danger\",\n        children: errors.password\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 30\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"password2\",\n          children: \"Confirm Password:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          className: \"form-control\",\n          id: \"password2\",\n          placeholder: \"Confirm password\",\n          name: \"confirmPassword\",\n          value: confirmPassword,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), (errors === null || errors === void 0 ? void 0 : errors.confirmPassword) && /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-danger\",\n        children: errors.confirmPassword\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"image\",\n          children: \"Image:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          className: \"form-control\",\n          id: \"endDate\",\n          placeholder: \"Enter image\",\n          name: \"image\"\n          /* value={image} */\n          ,\n          onChange: handleFileUpload,\n          disabled: uploaded_image\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary\",\n        disabled: !isEmpty(errors) || isEmptyForm(),\n        children: \"Submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 5\n  }, this);\n};\n\n_s(RegisterPage, \"hZ4oye1rgiTA1fmYSdBm8+/fMTw=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n\n_c = RegisterPage;\nexport default RegisterPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegisterPage\");","map":{"version":3,"sources":["/media/moataz/data/my-projects/react projects/events-app/frontend/src/components/pages/RegisterPage.js"],"names":["React","useState","useEffect","useDispatch","useSelector","register","upload_image","Joi","isEmpty","RegisterPage","history","username","setUserName","email","setEmail","password","setPassword","confirmPassword","setConfirmPassword","image","setImage","errors","setErrors","schema","string","required","validate","form","result","abortEarly","validateInput","name","value","error","details","message","newErrors","dispatch","uploaded_image","state","authReducer","user","handleChange","evt","target","handleSubmit","preventDefault","formErrors","i","length","path","handleFileUpload","x","FormData","append","files","push","isEmptyForm"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { register, upload_image } from '../../store/actions/userActions';\nimport Joi from 'joi-browser';\nimport {isEmpty} from '../../utils';\n\nconst RegisterPage = ({history}) => {\n  const [username, setUserName] = useState('');\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [image, setImage] = useState('anonymous');\n  const [errors, setErrors] = useState({});\n\n  const schema = {\n    username: Joi.string().required(),\n    email: Joi.string().email().required(),\n    password: Joi.string().required(),\n    confirmPassword: Joi.string().required()/* ,\n    image: Joi.string() */\n  };\n  const validate = (form) => { const result = Joi.validate(form, schema, { abortEarly: false }); return result; };\n  const validateInput = (name, value) => {\n    const { error } = Joi.validate({ [name]: value }, { [name]: schema[name] });\n    if (error) setErrors({ ...errors, [name]: error.details[0].message });\n    else {\n      let newErrors = { ...errors };\n      delete newErrors[name];\n      setErrors({ ...newErrors });\n    }\n\n  };\n  const dispatch = useDispatch();\n   const uploaded_image = useSelector((state)=> state.authReducer.uploaded_image);\n   const user = useSelector((state)=> state.authReducer.user);\n  const handleChange = (evt) => {\n    if (evt.target.name == 'username') { setUserName(evt.target.value); }\n    else if (evt.target.name == 'email') { setEmail(evt.target.value); }\n    else if (evt.target.name == 'password') { setPassword(evt.target.value); }\n    else if (evt.target.name == 'confirmPassword') { setConfirmPassword(evt.target.value); }\n    /* else if (evt.target.name == 'image') { console.log(evt.target.files[0].name);  handleFileUpload(evt);} */\n    validateInput(evt.target.name, evt.target.value);\n\n  };\n\n\n  const handleSubmit = (evt) => {\n    evt.preventDefault();\n    const form = { username, email, password, confirmPassword };\n    const { error, value } = validate(form);\n    if(!isEmpty(error)){\n    let formErrors = {};\n    \n    for (let i = 0; i < error.details.length; i++) {\n      formErrors[error.details[i].path[0]] = error.details[i].message;\n    }\n    if(form.password != form.confirmPassword) {\n      formErrors['password'] = formErrors['password']?formErrors['password'] + '  password and confirmed password are not match':formErrors['password'];\n      formErrors['confirmPassword'] = formErrors['confirmPassword']? formErrors['confirmPassword'] + '  password and confirmed password are not match':formErrors['confirmPassword'];\n    }\n    setErrors(formErrors);\n  }\n  else{\n  if(image){form['image'] = image;}\n      dispatch(register(form));\n  }\n    };\n\n  const handleFileUpload = (evt) => {\n    const x = new FormData();\n  x.append('avatar',evt.target.files[0]);\n  dispatch(upload_image(x));\n  \n  };\n\n  useEffect(() => {\n   setImage(uploaded_image);\n   if(!isEmpty(user)) {history.push('/');}\n  \n  }, [uploaded_image, user]);\n\n  const isEmptyForm = () => {\n    return (username + email + password + confirmPassword + image == \"\");\n  };\n\n  return (\n    <div>\n      <form onSubmit={handleSubmit}>\n        <div className=\"form-group\">\n          <label for=\"username\">Username:</label>\n          <input type=\"text\" className=\"form-control\" id=\"username\" placeholder=\"Enter name\" name=\"username\" value={username} onChange={handleChange} />\n        </div>\n        {errors?.username && <div class=\"alert alert-danger\">\n          {errors.username} \n        </div>}\n        \n\n        <div className=\"form-group\">\n          <label for=\"email\">email:</label>\n          <input type=\"text\" className=\"form-control\" id=\"email\" placeholder=\"Enter email\" name=\"email\"\n            value={email} onChange={handleChange} />\n        </div>\n        {errors?.email && <div class=\"alert alert-danger\">\n          {errors.email} \n        </div>}\n\n        <div className=\"form-group\">\n          <label for=\"password1\">Password:</label>\n          <input type=\"password\" className=\"form-control\" id=\"password1\" placeholder=\"Enter password\" name=\"password\"\n            value={password} onChange={handleChange} />\n        </div>\n        {errors?.password && <div class=\"alert alert-danger\">\n          {errors.password} \n        </div>}\n\n        <div className=\"form-group\">\n          <label for=\"password2\">Confirm Password:</label>\n          <input type=\"password\" className=\"form-control\" id=\"password2\" placeholder=\"Confirm password\" name=\"confirmPassword\"\n            value={confirmPassword} onChange={handleChange} />\n        </div>\n        {errors?.confirmPassword && <div class=\"alert alert-danger\">\n          {errors.confirmPassword} \n        </div>}\n\n        <div className=\"form-group\">\n          <label for=\"image\">Image:</label>\n          <input type=\"file\" className=\"form-control\" id=\"endDate\" placeholder=\"Enter image\" name=\"image\"\n            /* value={image} */ onChange={handleFileUpload} disabled={uploaded_image} />\n        </div>\n\n\n\n\n        <button type=\"submit\" className=\"btn btn-primary\" disabled={!isEmpty(errors) || isEmptyForm()}>Submit</button>\n      </form>\n\n    </div>\n  )\n}\n\nexport default RegisterPage;\n"]},"metadata":{},"sourceType":"module"}